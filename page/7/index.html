<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Adventures in HttpContext &middot; All the stuff after &#39;Hello, World&#39;
    
  </title>

  
  <link rel="stylesheet" href="http://blog.michaelhamrah.com/css/poole.css">
  <link rel="stylesheet" href="http://blog.michaelhamrah.com/css/syntax.css">
  <link rel="stylesheet" href="http://blog.michaelhamrah.com/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://blog.michaelhamrah.com/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="http://blog.michaelhamrah.com/assets/favicon.ico">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://blog.michaelhamrah.com/atom.xml">
</head>


  <body>

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Michael Hamrah</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item  active " href="http://blog.michaelhamrah.com/">Home</a>
    <a class="sidebar-nav-item " href="http://blog.michaelhamrah.com/post">Posts</a>

    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a class="sidebar-nav-item " href="http://blog.michaelhamrah.com/about/">About</a>
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="http://linkedin.com/in/hamrah">LinkedIn</a>
    <a class="sidebar-nav-item" href="http://twitter.com/mhamrah">@mhamrah</a>
    <a class="sidebar-nav-item" href="http://github.com/mhamrah">GitHub</a>
  </nav>

  <div class="sidebar-item">
    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="http://blog.michaelhamrah.com/" title="Home">Adventures in HttpContext</a>
            <small>All the stuff after &#39;Hello, World&#39;</small>
          </h3>
        </div>
      </div>

      <div class="container content">





<div class="posts">
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2010/02/performance-tracing-for-your-applications-via-enterprise-library/">Performance Tracing For Your Applications via Enterprise Library</a></h1>
        <span class="post-date">Feb 13 2010</span>
        <p>Performance is one of the most important, yet often overlooked, aspects of programming.  It&#8217;s usually not something you worry about until it gets really bad.  And at that point, you have layers of code you need to sift through to figure out where you can remove bottlenecks.  It&#8217;s also tricky, especially on complex, process orientated systems, to aggregate performance information for analysis.  That&#8217;s where this <a href="http://gist.github.com/302225">gist for a utility performance tracer class comes into play</a>.  It&#8217;s meant to hook into Enterprise Library Logging Block by aggregating the elapsed time or information statements and pass them to the Event Log (or other listeners you&#8217;ve hooked up).  Even though the gist is designed for the Enterprise Library, it can easily be modified for other utilities like Log4Net.  Below is an example of how the entry looks in the EventLog.</p>

<p style="text-align: center;">
  <a href="http://i1.wp.com/www.michaelhamrah.com/blog/wp-content/uploads/2010/02/event-log-examoke.png"><img class="size-full wp-image-350 aligncenter" title="event log example" src="http://i1.wp.com/www.michaelhamrah.com/blog/wp-content/uploads/2010/02/event-log-examoke.png?resize=483%2C526" alt="" data-recalc-dims="1" /></a>
</p>

<p><strong>Why Do It?</strong></p>

<p>I was disappointed with the built in trace listener provided with Enterprise Library.  It would write a begin and end message to the trace utility, and output a rather verbose message containing only a few relevant lines.  Even though it was easy to use in a using() statement, it was rather difficult to view related trace statements for a single high-level call.  I could have explored using the Tracer class more effectively, but isn&#8217;t always easier to write your own?</p>

<p><strong>How it Works</strong></p>

<p>Usually you&#8217;ll create an instance of the PerformanceTracer in a using statement, just like the Tracer class.</p>

<pre class="brush: csharp; title: ; notranslate" title="">using(new PerformanceTracer("How long does this function take?") {
     //Your Code Here
}
</pre>

<p>This will write the current message as the Title of the LogEntry and write the elapsed time between instantiation and disposal (thanks to the IDisposable pattern).  But the real benefit comes when you use the instantiated class for tracing within the using block:</p>

<pre class="brush: csharp; title: ; notranslate" title="">using(var tracer = new PerformanceTracer("Some long process") {
    //Step One
    tracer.WriteElapsedTime("Step One Complete");
    //Step Two
    tracer.WriteElapsedTime("Step Two Complete");
}
</pre>

<p>This will write both the elapsed time and the difference between statement calls, and will allow you to easily gain insight into long running steps.  There&#8217;s also another method <em>WriteInfo</em>, which allows you to write important information without clogging the performance messages.  This is important for information such as the current user, or information about the request:</p>

<pre class="brush: csharp; title: ; notranslate" title="">tracer.WriteInfo("CurrentUser", Identity.User);
tracer.WriteInfo("QueryString", Request.QueryString);
</pre>

<p>More often than not you probably differ high level function calls (those that orchestrate complex logic) to sub routines.  In Domain Driven Design, your Domain objects will probably interact with support services or other entities.  You may need to gain insight into these routines, but you don&#8217;t want to create separate tracers- that will create multiple EventLog entries and won&#8217;t give you a clear picture of the entire process.  In a production environment, where there could be hundreds of concurrent requests, aggregating those calls in a meaningful way is a nightmare.  That&#8217;s the main issue I had with the default Tracer class.  The solution for the PerformanceTracer is simple-  In your dependent classes you create a property of type IPerformanceTracer.  There are two extension methods, <em>LogPerformanceTrace</em> and <em>LogInfoTrace</em> you can use dependent classes.  These simply do a null object check before writing the trace so you don&#8217;t get any nasty null reference errors- helpful if you need to add logging and don&#8217;t want to update dependencies in your unit tests.  Notice how in the example above there was one call which took the majority of the time? I should probably get more insight into that function to see what&#8217;s going on.  Here&#8217;s an example of a property/extension method combination:</p>

<pre class="brush: csharp; title: ; notranslate" title="">//Create a property to store the tracer
public IPerformanceTracer Tracer { get; set; }
public void MySubRoutineCalledFromAnotherFunction(string someParam)
{
    //Do Work
    Tracer.LogPerformanceTracer("Subroutine Step One");
    //Do More Work
    Tracer.LogPerformanceTrace("Subroutine Step Two");
}
</pre>

<p>It doesn&#8217;t matter if the Tracer property is set, because the extension method handles null objects correctly. You could also put the tracer entity in an IoC framework and pull it out that way.  I prefer this approach when dealing with web apps.  You can create the tracer in a BeginRequest HttpModule, plug it into a container, and pull it out in the EndRequest method and dispose of it.  Using the tracer with a Per WebRequest Lifetime Container, supported with most frameworks, is even better.  This way it&#8217;s available everywhere without have to wire up new properties, and you can scatter it around in various places.  Here&#8217;s some code which pulls it out of a ServiceLocator ActionFilterAttribute in a ASP.NET MVC App:</p>

<pre class="brush: csharp; title: ; notranslate" title="">public class PerformanceCounterAttribute : ActionFilterAttribute

{

IPerformanceTracer tracer;

public override void OnActionExecuting(ActionExecutingContext filterContext)

{

     tracer = ServiceLocator.Current.GetInstance&lt;IPerformanceTracer&gt;();

     tracer.LogPerformanceTrace("Action Executing");

}

public override void OnResultExecuted(ResultExecutedContext filterContext)

{

     tracer.LogPerformanceTrace("Result Finished");

}

public override void OnActionExecuted(ActionExecutedContext filterContext)

{

     tracer.LogPerformanceTrace("Action Finished");

}

}

</pre>

<p>The final aspect of this setup is formatting the output.  EnterpriseLibrary provides a ton of information about the the context which logged the entry- not all of it may be applicable to you.  I use a customer formatter to only write the Title, Message and Category of the trace, like so:</p>

<pre class="brush: xml; title: ; notranslate" title="">&lt;formatters&gt;
 &lt;add template="Title:{title}&#xA;Message: {message}&#xA;Category: {category}" type="Microsoft.Practices.EnterpriseLibrary.Logging.Formatters.TextFormatter, Microsoft.Practices.EnterpriseLibrary.Logging, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" name="Text Formatter"/&gt;
 &lt;/formatters&gt;
</pre>

<p>This makes entries so much more readable. By default, the EventLog takes care of important information like the Computer name and Timestamp. So I can keep the message info very clean.</p>

<p>﻿One thing I&#8217;m specifically not trying to do is get an average of the same function call over a period of time.  That insight is also very important in understanding bottlenecks.  But what I&#8217;m trying to do is get a broad sense of the flow of a large process and see which chunks can be improved.  With the ability to aggregate EventLogs in a single place, I can easily sift through and see how my app is behaving in production.  By linking that with relevant information like the current user, url, and query string, I can find specific scenarios which are problematic that may not have gotten caught in lower environments.</p>

<p>A copy of the entire class is below, and available from GitHub.  It doesn&#8217;t make sense to roll out an entire project for it- just roll it somewhere in your app and tweak as necessary.  Then enjoy finding all the places you could optimize!</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2010/02/using-flickr-and-jquery-to-learn-jsonp/">Using Flickr and jQuery to learn JSONP</a></h1>
        <span class="post-date">Feb 5 2010</span>
        <p>I was playing around with the Flickr API recently and got a little stuck: when using jQuery to call the <a href="http://www.flickr.com/services/feeds/">Flickr public feed</a> using jQuery&#8217;s $.getJSON method, I wasn&#8217;t getting any results.  I thought maybe I was parsing the response incorrectly, but when I went to check out the data coming back in firebug, nothing was there.  I couldn&#8217;t believe it- the response headers were present, but the body was blank.  Calling the public feed url from the browser worked fine.  What&#8217;s more interesting was everything worked in IE.  So I did some experimenting and learned the issue: I wasn&#8217;t correctly using the endpoint to work with <a href="http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/">JSONP</a>, which is required when using jQuery with Flickr.  Then I thought I better learn more about JSONP.</p>

<p>There are <a href="http://www.insideria.com/2009/03/what-in-the-heck-is-jsonp-and.html">plenty of good articles</a> about <a href="http://en.wikipedia.org/wiki/JSON#JSONP">JSONP</a> on the net.  Essentially, JSONP allows you to specify custom callbacks when making remote ajax calls.  Firefox seems to be more strict when dealing with jsonp, which is why I didn&#8217;t get a response body.  What did the trick was adding the</p>

<pre class="syntax js">jsoncallback=?</pre>

<p>query string parameter to the end of my Flickr url.  This allows the jQuery framework to route to the default success function you pass to .getJSON(), like so:</p>

<pre class="syntax js">$.getJSON(
            'http://api.flickr.com/services/feeds/photos_public.gne?format=json&jsoncallback=?',
               function(data) {
                   $.each(data.items, function(i, item) {
                       $("img").attr("src", item.media.m).appendTo("#images");
                   });
               });
</pre>

<p><a href="http://www.michaelhamrah.com/blog/wp-content/FlickrJsonp.html">Here&#8217;s an example of this call</a>.   So what happens if we replace the ? with something else? Well, passing a simple text string will be treated like a normal function call.  Take a look at the example below:</p>

<pre class="syntax js">function GetItemsUsingExternalCallback() {
            $.ajax({ url: 'http://api.flickr.com/services/feeds/photos_public.gne?format=json&jsoncallback=myCallbackFunction',
                dataType: 'jsonp'
            });
        }
  function myCallbackFunction(data) {
  //dostuff
  }
</pre>

<p>jQuery will try and call &#8220;myCallbackFunction&#8221; as a normal function call instead of routing to the standard success function that&#8217;s part of the getJSON call.  <a href="http://www.michaelhamrah.com/blog/wp-content/FlickrJsonp.html">The example page also includes this approach.</a> There&#8217;s only a slight difference between the two approaches, but it&#8217;s cool that jQuery can call a function outside of the normal success callback.  Of course, if you needed to reuse a common callback across multiple ajax calls, you&#8217;d probably want to call that function directly from the success method, rather than inlining the function in the .ajax call.</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2010/02/how-eaccelerator-improved-wordpress-on-my-fedora-server/">How eAccelerator Improved WordPress on My Fedora Server</a></h1>
        <span class="post-date">Feb 1 2010</span>
        <p>I recently moved this blog and some other smaller websites to a virtual machine running on <a href="http://www.michaelhamrah.com/blog/2010/01/rocking-the-rackspace-cloud/">Rackspace Cloud</a>. So far I&#8217;m loving having my own server, and have been able to get my hands dirty with Linux administration, apache, and mysql.</p>

<p>But one quirk was really bothering me: at times, my WordPress blog would hang. I don&#8217;t get too much traffic, and using</p>

<pre class="brush: bash; title: ; notranslate" title="">top</pre>

<p>showed no real load on the cpu. But there were a lot of Apache threads with a good chunk of memory allocated, and I had a little free memory available.  I tried adding more memory to the server, but no luck.  I thought the issue could be mysql, but running queries wasn&#8217;t a problem.  Neither was static html- the root index.html loaded quickly.  So that left php itself.</p>

<p>A couple of apache config changes didn&#8217;t help.  The thing which really did the trick was installing <a href="http://eaccelerator.net/">eAccelerator</a>.  This tool simply keeps the compiled php script available, so apache doesn&#8217;t have to recompile the php script on every load.  No, the blog is a lot faster and much more reliable.</p>

<p>Installation is easy on Fedora (or CentOS, or whatever distro uses yum):</p>

<pre class="brush: bash; title: ; notranslate" title="">sudo yum install php-accelerator</pre>

<p>then just restart apache and you&#8217;re good to go:</p>

<pre class="brush: bash; title: ; notranslate" title="">sudo /sbin/service httpd reload</pre>

<p>If you don&#8217;t notice an immediate improvement, and want to check to make sure it&#8217;s loaded, then create a info.php file with the following code:</p>

<pre class="brush: php; title: ; notranslate" title="">&lt;?php phpinfo(); ?&gt;</pre>

<p>and you should see the accelerator info in the list.</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2010/01/an-outlook-macro-to-archive-items-like-gmail/">An Outlook Macro to Archive Items like GMail</a></h1>
        <span class="post-date">Jan 25 2010</span>
        <p>I&#8217;m a big fan of Gmail&#8217;s archive feature- I can move items out of the inbox quickly and find them later with search.  To mimic this behavior at work with outlook, I&#8217;ve created this quick and dirty macro which does the job.  Simply create a folder named &#8220;archive&#8221; in your mailbox.  When you run the macro, it will move the current item in your inbox to that folder.  I&#8217;ve created a keystroke which lets me run the macro easily.</p>

<pre class="brush: vb; title: ; notranslate" title="">Sub ArchiveItem()

On Error Resume Next

 Dim objFolder As Outlook.MAPIFolder, objInbox As Outlook.MAPIFolder
 Dim objNS As Outlook.NameSpace, objItem As Outlook.MailItem

 Set objNS = Application.GetNamespace("MAPI")
 Set objInbox = objNS.GetDefaultFolder(olFolderInbox)
 Set objFolder = objInbox.Parent.Folders("Archive")

'Assume this is a mail folder
 If objFolder Is Nothing Then
 MsgBox "This folder doesn't exist!", vbOKOnly + vbExclamation, "INVALID FOLDER"
 End If

 If Application.ActiveExplorer.Selection.Count = 0 Then
 'Require that this procedure be called only when a message is selected
 Exit Sub
 End If

 For Each objItem In Application.ActiveExplorer.Selection
 If objFolder.DefaultItemType = olMailItem Then
 If objItem.Class = olMail Then
 objItem.Move objFolder
 End If
 End If
 Next

 Set objItem = Nothing
 Set objFolder = Nothing
 Set objInbox = Nothing
 Set objNS = Nothing
End Sub

</pre>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2010/01/rocking-the-rackspace-cloud/">Rocking the Rackspace Cloud</a></h1>
        <span class="post-date">Jan 13 2010</span>
        <p>I&#8217;ve been unhappy with my current hosting provider and in looking for an alternative I tried <a href="http://www.rackspacecloud.com/cloud_hosting_products/servers">Rackspace Cloud Server</a>.  I&#8217;ve wanted a dedicated server for a while, but it&#8217;s been cost prohibitive compared to shared machine hosting.  This blog, as well as some other, smaller sites, are now running on a Rackspace Cloud Server.  Needless to say I love it.  Rackspace Cloud Server is simply awesome.</p>

<p><strong>Setup</strong></p>

<p>Signing up and setup was fast and simple.  There was a weird account verification process where Rackspace had to call me to finalize and confirm setup, but I only had to wait about ten minutes after I signed up for the call.  After that, it was only a couple of clicks before I was logging in to my new server.  There are several Linux images to choose from- you select the size of the machine you want and the os- and within seconds you have a public ip v4 address and root access. For me that was the most amazing part of cloud computing- I wanted a new server, and I got one with instant gratification.</p>

<p><strong>Getting Started</strong></p>

<p>I&#8217;m not a Linux expert coming from the Windows world, but I was able to configure everything and install mysql/apache in no time.  Rackspace has a <a href="http://cloudservers.rackspacecloud.com/index.php/Main_Page">series of extremely well written and straightforward how-to&#8217;s to get your server configured correctly</a>.  Each OS image is a stripped down bare-bones install so there&#8217;s some setup required, but by using the knowledge base I was up and running quickly.  Backups are integrated into the management website with Rackspace&#8217;s Cloud Files product, so I took a snapshot for reuse later.  You can even schedule snapshots as needed.</p>

<p>It&#8217;s really the knowledge base which I loved- I got ftp, apache, php, ssh, mysql all installed and secured quickly.  There&#8217;s a wealth of information there.  If you need to learn Linux or do anything with popular OS applications check out their kb. I&#8217;ve never seen so much easy to access documentation on open source software in one place.</p>

<p>**Other Goodies</p>

<p>**</p>

<p>The reason why I wanted to try Rackspace is because the cost of entry is extremely cheap- it starts at 1.5 cents/hr which comes out to about $11/month.  Much cheaper than Amazon&#8217;s EC2, which starts around $20 only if you prepay.  There are a lot of major differences between the two products which I talk about below.</p>

<p>Rackspace Servers come in different sizes all differentiated by the amount of RAM.  I chose the 256mb option because it was the cheapest.  It turns out it was a little too light on power for what I wanted, so I upgraded to the 512mb option.  The upgrade was seemless- you just say &#8220;make this a 512mb server&#8221;, and Rackspace queues the request, reboots when appropriate, you verify, and then you get the same server with better &#8220;hardware&#8221;.  Loved it.  I queued the request before I left work and it was good to go when I got home.</p>

<p>The best part about Rackspace is the support.  There&#8217;s a live chat link from the management page.  I had a question about DNS- I clicked live chat- had a quick IM conversation- got the answer- and I was done.  That&#8217;s service.</p>

<p><strong>Rackspace vs. EC2</strong></p>

<p>The main reason I chose Rackspace over EC2 was cost.  But in looking into the differences between Rackspace and EC2 I&#8217;m happy I chose Rackspace.  The biggest difference is with Rackspace you can reboot the OS without losing state- so if you make configuration change or install some software, a reboot behaves like you&#8217;d expect- everything stays the same.  EC2, on the other hand, resets the server state back to what it was on the first boot.  You need to have your EC2 server link to EBS to persist state. WIth Rackspace you get a hard drive which acts, surprisingly, just like a hard drive.</p>

<p>With Rackspace, the default is ip v4, but with AWS, it&#8217;s ip v6 and you need to link to an ip v4 address.  The initial setup is also slightly different- EC2 involves the use of a keypair for the initial login, but Rackspace gives you root access which you then change and configure as needed.  I haven&#8217;t actually set up an EC2 server but by looking at the how to I an safely say Rackspace is a lot simpler.</p>

<p>Another major difference in options is the &#8220;size&#8221; of the server.  EC2 is explicit in the hardware configuration- RAM, cpu power, cores, etc.  Size is capped.  Rackspace takes a different approach: all CPUs are 64 bit with four cores and you only choose the amount of RAM.  Storage and CPU power change with the size of RAM.  You&#8217;re guaranteed a certain minimum power (rather than a capped maximum), and if more power is available you get it.</p>

<p>I can say EC2 has much more options available for OSes- EC2 offers Windows in addition to Linux (apparently this is coming soon to Rackspace).  I also like the idea of EC2&#8217;s community AMI&#8217;s.  You only get a bare bones OS with Rackspace, but with EC2 you can get a fully configured LAMP stack or some other ready-to-go server.  But it was fun getting everything set up myself with Rackspace.  I haven&#8217;t done a long haul with either product, and like I said I haven&#8217;t actually spun up an EC2 instance, so I can&#8217;t get into any more descriptive details.</p>

<p><strong>Rocking the Cloud</strong></p>

<p>I can&#8217;t tell you how fun it is to be able to spin up a new server out of the blue.  There are a million things I want to do- being able to run a server full time, with great bandwidth, without having to find a place for it in my house (or buy and salvage hardware) is just geeky awesome.  And for only $11/mo!  It&#8217;s crazy!  Whether with Rackspace or Amazon I encourage you to give it a shot.  I encode a lot of video for my ipod, which means running my laptop at night or slow performance when doing other things.  I&#8217;d love to be able to spin up a server, upload a video, encode it, pull it down, and shut down the server to save money.  Power on demand!</p>

<p>Disclaimer: I own stock in both Rackspace and Amazon, but I wasn&#8217;t paid nor asked to write this article.</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2009/12/getting-ruby-1-9-readline-rails-and-mysql-all-running-on-snow-leopard/">Getting Ruby 1.9, Readline, Rails, and Mysql all running on Snow Leopard</a></h1>
        <span class="post-date">Dec 27 2009</span>
        

<p>In my never ending love/hate relationship with Ruby, Rails and my Mac I&#8217;ve finally gotten Ruby 1.9 up and running with Rails 2.3 and MySql 64 bit.  All on Snow Leopard.  There was an even a little detour with Readline.  If you&#8217;ve scoured other posts about Snow Leopard, Ruby, Rails and Mysql and ended up here I feel your pain.  I hope this helps you on your way. <a href="http://wonko.com/post/how-to-compile-ruby-191">Most of this info</a> is from other places which I&#8217;ve explained in a little (just a little) but more depth.</p>

<h3 id="install-xcode:c926fa09a3f264a43863b502ab5b6f5a">Install XCode</h3>

<p>You need XCode to do any of this, so install it.  If you&#8217;re upgrading to Snow Leopard, reinstall XCode so you get the correct c compiler.</p>

<h3 id="your-profile:c926fa09a3f264a43863b502ab5b6f5a">Your profile</h3>

<p>Here&#8217;s the deal.  We&#8217;re going to install ruby 1.9 to your /usr/local directory.  It will dump stuff in /usr/local/bin and other stuff in /usr/local/lib.  Why here?  That&#8217;s where it goes.  The default install of ruby on Snow Leopard 1.8, lives in /System/Library/Frameworks/Ruby.framework/Versions/Current.  Current is really an alias (actually, symlink) to the 1.8 directory at the same level.  For some it may seem like a good idea to install ruby 1.9 here.  It&#8217;s not.  Just put in /usr/local like everyone else.</p>

<p>Because ruby 1.9 will live in our /usr/local you have to help out your terminal a little.  You have to tell it where to look for the bin of ruby 1.9.  So when you run &#8220;ruby&#8221; from terminal you get the 1.9 version in /usr/local, not the 1.8 version in the System Library.  That&#8217;s why you have to add a path to /usr/local in your profile.  Do this from the terminal:</p>

<pre class="brush: bash; title: ; notranslate" title="">mate ~/.bash_profile
</pre>

<p>This says, &#8220;open or create the file .bash_profile, in the home directory (~/), using textmate&#8221;.  You can use any other editor if you know how- but if you did you probably wouldn&#8217;t need to read this.  So just buy- and use- textmate.  It&#8217;s a nice app.  Now, .bash_profile is a file used by bash, aka the terminal app, for settings.  Some places you&#8217;ll see &#8220;mate .profile&#8221; instead.  <a href="http://hayne.net/MacDev/Notes/unixFAQ.html">This will work too</a>&#8211; but if you have a .profile and .bash_profile you may run in to problems.  Just have one, preferably .bash_profile, and write this in it:</p>

<pre class="brush: bash; title: ; notranslate" title="">export PATH=/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:$PATH
</pre>

<p>This appends our /usr/local/bin and sbin to the current list of directories to search for when trying to find out where all those little commands live which you type into the terminal.  Keen eyes may have noticed the mysql/bin thrown in there.  This is for later.  The :$PATH at the end is extremely important- it includes other paths which are included in other places. Once this is done then type &#8220;source .bash_profile&#8221; from terminal to load the changes.</p>

<h3 id="try-installing-ruby:c926fa09a3f264a43863b502ab5b6f5a">Try Installing Ruby</h3>

<p>One way to install ruby is by using <a href="http://www.macports.org/">MacPorts</a>.  If you want to get a little more hands on, we&#8217;re going to pull the source down and build it ourselves.  MacPorts is probably the easiest option.  We&#8217;re not doing the easy option.</p>

<p>Note: Read all this first!  In the terminal, make sure you&#8217;re in your home directory by doing a simple &#8220;cd&#8221;.  Then, do this:</p>

<pre class="brush: bash; title: ; notranslate" title="">mkdir src
cd src
</pre>

<p>We&#8217;re creating a new directory called src for our source files, and moving into said directory.  Now we can get the code:</p>

<p>curl -O <a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p376.tar.gz">ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p376.tar.gz</a></p>

<p>tar xzvf ruby-1.9.1-p376.tar.gz</p>

<p>cd ruby-1.9.1-p376/</p>

<p>Curl is a nice little app to pull things from the internet.  The -O option simply names the local file the same as the remote file.  Ruby 1.9.1-p376 was the latest version as of this writing, but [In my never ending love/hate relationship with Ruby, Rails and my Mac I&#8217;ve finally gotten Ruby 1.9 up and running with Rails 2.3 and MySql 64 bit.  All on Snow Leopard.  There was an even a little detour with Readline.  If you&#8217;ve scoured other posts about Snow Leopard, Ruby, Rails and Mysql and ended up here I feel your pain.  I hope this helps you on your way. <a href="http://wonko.com/post/how-to-compile-ruby-191">Most of this info</a> is from other places which I&#8217;ve explained in a little (just a little) but more depth.</p>

<h3 id="install-xcode-1:c926fa09a3f264a43863b502ab5b6f5a">Install XCode</h3>

<p>You need XCode to do any of this, so install it.  If you&#8217;re upgrading to Snow Leopard, reinstall XCode so you get the correct c compiler.</p>

<h3 id="your-profile-1:c926fa09a3f264a43863b502ab5b6f5a">Your profile</h3>

<p>Here&#8217;s the deal.  We&#8217;re going to install ruby 1.9 to your /usr/local directory.  It will dump stuff in /usr/local/bin and other stuff in /usr/local/lib.  Why here?  That&#8217;s where it goes.  The default install of ruby on Snow Leopard 1.8, lives in /System/Library/Frameworks/Ruby.framework/Versions/Current.  Current is really an alias (actually, symlink) to the 1.8 directory at the same level.  For some it may seem like a good idea to install ruby 1.9 here.  It&#8217;s not.  Just put in /usr/local like everyone else.</p>

<p>Because ruby 1.9 will live in our /usr/local you have to help out your terminal a little.  You have to tell it where to look for the bin of ruby 1.9.  So when you run &#8220;ruby&#8221; from terminal you get the 1.9 version in /usr/local, not the 1.8 version in the System Library.  That&#8217;s why you have to add a path to /usr/local in your profile.  Do this from the terminal:</p>

<pre class="brush: bash; title: ; notranslate" title="">mate ~/.bash_profile
</pre>

<p>This says, &#8220;open or create the file .bash_profile, in the home directory (~/), using textmate&#8221;.  You can use any other editor if you know how- but if you did you probably wouldn&#8217;t need to read this.  So just buy- and use- textmate.  It&#8217;s a nice app.  Now, .bash_profile is a file used by bash, aka the terminal app, for settings.  Some places you&#8217;ll see &#8220;mate .profile&#8221; instead.  <a href="http://hayne.net/MacDev/Notes/unixFAQ.html">This will work too</a>&#8211; but if you have a .profile and .bash_profile you may run in to problems.  Just have one, preferably .bash_profile, and write this in it:</p>

<pre class="brush: bash; title: ; notranslate" title="">export PATH=/usr/local/bin:/usr/local/sbin:/usr/local/mysql/bin:$PATH
</pre>

<p>This appends our /usr/local/bin and sbin to the current list of directories to search for when trying to find out where all those little commands live which you type into the terminal.  Keen eyes may have noticed the mysql/bin thrown in there.  This is for later.  The :$PATH at the end is extremely important- it includes other paths which are included in other places. Once this is done then type &#8220;source .bash_profile&#8221; from terminal to load the changes.</p>

<h3 id="try-installing-ruby-1:c926fa09a3f264a43863b502ab5b6f5a">Try Installing Ruby</h3>

<p>One way to install ruby is by using <a href="http://www.macports.org/">MacPorts</a>.  If you want to get a little more hands on, we&#8217;re going to pull the source down and build it ourselves.  MacPorts is probably the easiest option.  We&#8217;re not doing the easy option.</p>

<p>Note: Read all this first!  In the terminal, make sure you&#8217;re in your home directory by doing a simple &#8220;cd&#8221;.  Then, do this:</p>

<pre class="brush: bash; title: ; notranslate" title="">mkdir src
cd src
</pre>

<p>We&#8217;re creating a new directory called src for our source files, and moving into said directory.  Now we can get the code:</p>

<p>curl -O <a href="ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p376.tar.gz">ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p376.tar.gz</a></p>

<p>tar xzvf ruby-1.9.1-p376.tar.gz</p>

<p>cd ruby-1.9.1-p376/</p>

<p>Curl is a nice little app to pull things from the internet.  The -O option simply names the local file the same as the remote file.  Ruby 1.9.1-p376 was the latest version as of this writing, but]<a href="http://www.ruby-lang.org/en/">4</a> for the latest release.  Tar xzvf simply unpacks the compressed download.</p>

<p><strong>Very helpful hint:</strong> <em>If you ever are unsure about a command, simply type the command and &#8211;help.  As in, curl &#8211;help.  This is very helpful.</em></p>

<p>Next, we get to the good stuff.  First, run autoconf simply by typing &#8220;autoconf&#8221;:</p>

<pre class="brush: bash; title: ; notranslate" title="">autoconf</pre>

<p><a href="http://www.gnu.org/software/autoconf/">Autoconf</a> is a tool used for generating configuration scripts.  It&#8217;s important you run this.  Then, run the configuration script.  The thing which worked for me was:</p>

<pre class="brush: bash; title: ; notranslate" title="">./configure --prefix=/usr/local/ --enable-shared --with-readline-dir=/usr/local
</pre>

<p>This tells us to install ruby in the /usr/local directory, build a shared library for ruby, and use the readline installation found in /usr/local. <strong>Very Important:</strong> some users prefer adding a suffix to the ruby 1.9 install so it doesn&#8217;t interfere with the system install of ruby.  By adding the &#8211;program-suffix=19 option to configure you&#8217;ll append &#8220;19&#8221; to all commands, like &#8220;ruby19&#8243; and &#8220;gem19&#8243;.  This is a smart idea as it won&#8217;t interfere with the default ruby installation.  Using this technique there are ways to easily switch between ruby installations.  If you don&#8217;t care about 1.8, and just want the ease of typing &#8220;ruby&#8221; and getting the latest 1.9, omit the &#8211;program-suffix option.</p>

<p>If you run ./configure and get an error of:</p>

<p><em>configure: WARNING: unrecognized options: &#8211;with-readline-dir</em></p>

<p>You did not run autoconf.  Type it and run it, then run configure again.</p>

<p>Sometimes you&#8217;ll see the &#8211;enable-pthread option.  There seems to be some debate on whether this is a good idea.  I say omit it unless you know what you&#8217;re doing.  You can google for more info.  Feel free to explore and google other configure options- simply type &#8220;configure &#8211;help&#8221; to list them all.</p>

<p>Next we need to run:</p>

<pre class="brush: bash; title: ; notranslate" title="">make</pre>

<p>This builds all the source files needed for the install.  If you run this and get an error of:</p>

<p>readline.c: In function â€˜username_completion_proc_callâ€™:</p>

<p>readline.c:1159: error: â€˜username_completion_functionâ€™ undeclared (first use in this function)</p>

<p>You don&#8217;t have readline- or at least the proper version of readline- installed.  This is a problem.  Let&#8217;s get it.</p>

<h3 id="readline:c926fa09a3f264a43863b502ab5b6f5a">Readline</h3>

<pre class="brush: bash; title: ; notranslate" title="">cd ~/src
curl -O ftp://ftp.gnu.org/gnu/readline/readline-6.0.tar.gz
tar xzvf readline-6.0.tar.gz
cd readline-6.0
./configure --prefix=/usr/local
make
sudo make install
</pre>

<p>You&#8217;ve now installed readline.  You may get a warning of <em>install: you may need to run ldconfig at</em> at the end<em>.</em> Don&#8217;t worry about it.  At least I didn&#8217;t have to worry about it.</p>

<h3 id="do-everything-again:c926fa09a3f264a43863b502ab5b6f5a">Do everything again</h3>

<p>By now, you know the drill.  Hop back to the ruby source code directory and try it again.  But if you ran make in the ruby install step and got errors, just run &#8220;make clean&#8221; to reset everything.  It&#8217;s a good idea.</p>

<pre class="brush: bash; title: ; notranslate" title="">make clean
autoconf
./configure --prefix=/usr/local/ --with-readline-dir=/usr/local --enable-shared
make
sudo make install
</pre>

<p>That should be it.  Hopefully you&#8217;re error free.  Typing:</p>

<pre class="brush: bash; title: ; notranslate" title="">which ruby</pre>

<p>should return:</p>

<p><em>/usr/local/bin/ruby</em></p>

<p>and typing &#8220;ruby -v&#8221; should return the version of ruby you&#8217;ve just downloaded.  Unless you used the &#8211;program-suffix option above, then it&#8217;s probably &#8220;ruby19 -v&#8221;</p>

<h3 id="r-ails:c926fa09a3f264a43863b502ab5b6f5a"><strong>R</strong><strong>ails</strong></h3>

<p>Now you can download and install rails.  Simply run:</p>

<pre class="brush: bash; title: ; notranslate" title="">sudo gem update --system
sudo gem install rails
</pre>

<h3 id="mysql:c926fa09a3f264a43863b502ab5b6f5a">Mysql</h3>

<p>Mysql is a piece of cake.  Simply grab the x86_64 <a href="http://dev.mysql.com/downloads/mysql/5.1.html#macosx-dmg">install package from the Mysql site.</a> Even though it&#8217;s for 10.5, it works fine on 10.6 (Snow Leopard).  Once this is done, you can build the mysql gem:</p>

<pre class="brush: bash; title: ; notranslate" title="">sudo env ARCHFLAGS="-arch x86_64" gem install mysql -- --with-mysql-config=/usr/local/mysql/bin/mysql_config
</pre>

<h3 id="fin:c926fa09a3f264a43863b502ab5b6f5a">Fin</h3>

<p>Now, try to get everything running.  Go back to your home directory, create a rails app, and see if it works:</p>

<pre class="brush: bash; title: ; notranslate" title="">cd ~/
rails playground --databse=mysql
cd playground
rake db:create
script/server
</pre>

<p>Go to <a href="http://localhost:3000">http://localhost:3000</a>, check your environment settings, and you should see:</p>

<table style="height: 164px;" width="256">
  <tr>
    <td>
      Ruby version
    </td>
    
    <td>
      1.9.1 (i386-darwin10.2.0)
    </td>
  </tr>
  
  <tr>
    <td>
      RubyGems version
    </td>
    
    <td>
      1.3.5
    </td>
  </tr>
  
  <tr>
    <td>
      Rack version
    </td>
    
    <td>
      1.0
    </td>
  </tr>
  
  <tr>
    <td>
      Rails version
    </td>
    
    <td>
      2.3.5
    </td>
  </tr>
  
  <tr>
    <td>
      Active Record version
    </td>
    
    <td>
      2.3.5
    </td>
  </tr>
  
  <tr>
    <td>
      Active Resource version
    </td>
    
    <td>
      2.3.5
    </td>
  </tr>
  
  <tr>
    <td>
      Action Mailer version
    </td>
    
    <td>
      2.3.5
    </td>
  </tr>
  
  <tr>
    <td>
      Active Support version
    </td>
    
    <td>
      2.3.5
    </td>
  </tr>
</table>

<p>And voila, you&#8217;re done!</p>

<p>UPDATE:</p>

<p>If you use Textmate to develop with Rails, your Textmate Ruby path will point to the system&#8217;s 1.8 version, so you&#8217;ll get awakard issues of Gems not being available or other weird stuff when trying to run Ruby within Textmate (like when you want to RSpec tests).  This fix is simple: go to Textmate -&gt; Preferences -&gt; Advanced -&gt; Shell Variables and add TM_RUBY with a value of /usr/local/bin/ruby and you&#8217;ll be good to go.</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2009/12/organizing-javascript-for-event-pooling-with-jquery/">Organizing Javascript for Event Pooling with jQuery</a></h1>
        <span class="post-date">Dec 21 2009</span>
        

<p>It turns out my most popular article of the past year was <a href="http://www.michaelhamrah.com/blog/index.php/2008/12/event-pooling-with-jquery-using-bind-and-trigger-managing-complex-javascript/">Event Pooling with jQuery&#8217;s Bind and Trigger</a>.&nbsp; I wanted to write a follow up article taking this approach one step further by discussing how to logically organize the relationship between binders and triggers on a javascript heavy UI.&nbsp; It&#8217;s important to properly design the code structure of your javascript to create a flexible and maintainable system.&nbsp; This is essential for any software application. &nbsp;For javascript development, you don&#8217;t want to end up with odd dependencies hindering changes or randomly bubbled events causing bugs.</p>

<h3 id="event-pooling-a-quick-review:b1aa778a626daa40c556fbd74954875f">Event Pooling: A Quick Review</h3>

<p>What is event pooling and why is it important?&nbsp; Quite simply it&#8217;s a way to manage dependencies.&nbsp; You create a loosely coupled system between the thing which triggers an action to happen and the thing which responds to the action, called the binder.&nbsp; jQuery has some cool bind and trigger functionality which allows you to create custom events for event pooling- and you can use this to easily wire up multiple functions to write complex javascript with ease.&nbsp; I encourage you to check out the original how-to article <a href="../index.php/2008/12/event-pooling-with-jquery-using-bind-and-trigger-managing-complex-javascript/">Event Pooling with jQuery&#8217;s Bind and Trigger</a> to learn more. &nbsp;It&#8217;s a very powerful technique.</p>

<p>Now, as we all know, with great power comes great responsibility.&nbsp; If you structure the relationship between binders and triggers incorrectly you&#8217;ll end up with a mess on your hands, a spider web of logic which is almost impossible to unwind.&nbsp; Here are some tips to better structure your binders and triggers for a logical and maintainable application</p>

<h3 id="presenting-the-problem:b1aa778a626daa40c556fbd74954875f">Presenting the Problem</h3>

<p><a href="http://i2.wp.com/www.michaelhamrah.com/blog/wp-content/uploads/2009/12/Stupid-Form1.png"><img class="alignleft size-medium wp-image-292" title="Stupid Form" src="http://i1.wp.com/www.michaelhamrah.com/blog/wp-content/uploads/2009/12/Stupid-Form1-300x179.png?resize=300%2C179" alt="Stupid Form" data-recalc-dims="1" /></a></p>

<p>Let&#8217;s take a look at an example app. &nbsp;Here&#8217;s a simple form where a user can draft a report, save it for later, or send it immediately. There are three options to enter data in the name/email/department field.&nbsp; The user can enter it manually, choose from the autosuggest area at left, or simply select one of the favorite links.&nbsp; The autosuggest/favorite link would pre-populate the textboxes used in the form. &nbsp;If all the data is there, the send button is enabled. &nbsp;If not, it&#8217;s disabled.</p>

<p>Let&#8217;s discuss how we&#8217;d deal with enabling and disabling the send button. &nbsp;There are many ways to approach this. &nbsp;A traditional way is to wire up some standard event to our textboxes:</p>

<pre class="brush: jscript; title: ; notranslate" title="">$('#name').keyup(function(){
    //Logic (hopefully structured in a reusable way across all controls).
});
//Do this for all other input controls.
</pre>

<p>This solution is perfectly valid and works, but it has some shortcomings. &nbsp;First, you need to wire up all three controls and route them to the same function. &nbsp;Next, even though the keyup will handle user input, the textboxes could change in other ways- either from the favorite link or the auto suggest box. &nbsp;We&#8217;ll need to call our validation function in numerous places. &nbsp;There may also be other logic we want to incorporate within the text change event unrelated to enabling of the send button- email validation, for instance, which is only applicable to the email textbox, or a certain length requirement on the name textbox. &nbsp;What happens if there&#8217;s a new requirement where the subject/body must be filled to enable the send button? Where does all this functionality fall into our larger requirements?</p>

<p>You can imagine the complexity of writing the javascript required for this UI. &nbsp;We need a slew of functions to deal with validation logic: Both for enabling the send button and other input controls. &nbsp;We need to wire up all our onkeyup and on click events across the auto suggest field, textboxes, and favorite links. &nbsp;Function calls are everywhere. &nbsp;It will take all your code complete skills to manage those dependencies and keep this code lean.</p>

<p>This is where event pooling comes into play: instead of direct dependencies between these controls and logic, you bubble events to a middle man and allow interested parties to respond accordingly. &nbsp;Instead of all the controls telling the send button to enable/disable itself, the send button &#8220;listens&#8221; for changes it cares about- when the value of the textbox changes- and responds accordingly. &nbsp;The responsibility is reversed- the function which needs to be called can choose when it&#8217;s called, rather than waiting for something to call it.</p>

<h3 id="dependencies-between-binders-and-triggers:b1aa778a626daa40c556fbd74954875f">Dependencies Between Binders and Triggers</h3>

<p>With event pooling there are two things you need to be conscience of:&nbsp; the events themselves and the data passed between the binder and trigger.&nbsp; These items form the two dependencies between binders and triggers.&nbsp; The event serves as a link between the binder and trigger and the data is the information which is passed between the two.&nbsp; It&#8217;s essential to properly structure your events and choose the right data transfer option to avoid pitfalls over the life of the application.&nbsp; We&#8217;ll deal with each aspect individually. &nbsp;This post will be about the structure of events, and I&#8217;ll write various ways to pass data between parties in another post.</p>

<h3 id="structuring-custom-events:b1aa778a626daa40c556fbd74954875f">Structuring Custom Events</h3>

<p><span style="font-weight: normal;">Most people are familiar with the standard javascript events: click, blur, enter, exit, etc.&nbsp; These are what you usually wire up to functions when you want to do something.&nbsp; However, they only go so far- you need custom events when you have a lot of stuff happening. &nbsp;Why use them?&nbsp; Quite simply, it&#8217;s more logical for your application control flow. &nbsp;For our send button functionality, we want our validation function to act when something happens. &nbsp;This &#8220;something&#8221; will be a custom event we create. &nbsp;We have two options for naming our event: we can name the event after what is intended, like &#8220;ENABLE_DISABLE_SEND_BUTTON&#8221;, or name the event after what has happened, like &#8220;NAME_CHANGED&#8221; or &#8220;FAVORITE_LINK_SELECTED&#8221;. &nbsp;The former option requires multiple events to be fired when something happens. &nbsp;The autosuggest box, for instance, would require the ENABLE_DISABLE_SEND_BUTTON trigger, a SELECTED_CONTACT event for setting the textboxes, and whatever else happens after a contact is selected. &nbsp;The latter option requires just one trigger to be fired, but the binder must subscribe to multiple events. &nbsp;The choice can also be presented like this: do we want each element to fire a trigger for each action which should occur, or have a function to listen for multiple triggered events?</span></p>

<p><span style="font-weight: normal;"><a href="http://i0.wp.com/www.michaelhamrah.com/blog/wp-content/uploads/2009/12/Event_Pooling-2-e1261347350823.png"><img class="aligncenter size-full wp-image-300" title="Event_Pooling-2" src="http://i0.wp.com/www.michaelhamrah.com/blog/wp-content/uploads/2009/12/Event_Pooling-2-e1261347350823.png?resize=600%2C317" alt="" data-recalc-dims="1" /></a><br /> </span></p>

<p>Naming events may seem like an arbitrary and thoughtless act, but it&#8217;s essential to have a naming strategy with event pooling. &nbsp;Just like wiring up functions directly can be unwieldy, so can a slew of events wired up every which way.</p>

<p><strong>For event pooling, it&#8217;s more important to name events after what has happened, rather than what is intended.</strong> So the correct approach is to go with things like &#8220;NAME_CHANGED&#8221;, &#8220;CONTACT_SELECTED&#8221;, or &#8220;EMAIL_CHANGED&#8221;. &nbsp;The rationale has to do with dependencies themselves: &nbsp;we don&#8217;t want functions called from random parts of the system via specific events: &nbsp;this is no better than calling functions directly from disparate parts of the system. &nbsp;And with specific action related events like &#8220;ENABLE_SEND&#8221; you just know someone is going to take a shortcut and wire some random binder to a totally unrelated trigger, because that trigger is fired from the control they want to monitor. &nbsp;Binders- and the functions they are wired to- should proactively &#8220;listen&#8221; for things which it&#8217;s interested in. &nbsp;This allows you to easily know why a function is being called. &nbsp;If you need to change why or how something is handled, you go to the recipient, not the caller. &nbsp;The caller, after all, could be anything, and more importantly the caller could be triggering multiple things.</p>

<pre class="brush: jscript; title: ; notranslate" title="">//Funnel all possibilities to single custom trigger
$('#name').bind('keyup enter', function() {
 $(document).trigger('NAME_CHANGED');
});

//Funnel all possibilites to single custom trigger
$('#email').bind('keyup enter', function() {
$(document).trigger('EMAIL_CHANGED');
});

//I know why this is being called because I've subscribed
//to the events I'm interested in.
$(document).bind('NAME_CHANGED EMAIL_CHANGED', function()
{
 //Handle validation, etc.
});
</pre>

<p>The cool thing about this approach is there may be something else which will cause an email or name changed event to happen: specifically, when someone has selected a contact from the autosuggest list or a favorite link is selected. &nbsp;You can fire the name_changed event from multiple places and not worry about wiring up any new triggers. &nbsp;The code would look something like this:</p>

<pre class="brush: jscript; title: ; notranslate" title="">//Fired from elsewhere
$(document).bind('FAVORITE_LINK_SELECTED', function()
{
  //Handle selection
  //Set Name, Email, etc.
  //Fire event:
  $(document).trigger('EMAIL_CHANGED');
  $(document).trigger('NAME_CHANGED');
});
</pre>

<p>How nice: &nbsp;another part of the system changes the name indirectly, and we don&#8217;t have to worry about hooking anything up because the binder is already subscribed to the NAME_CHANGED event.</p>

<p>Note the name doesn&#8217;t necessarily correspond to a specific element: It&#8217;s not a textbox_name_changed event, nor are any specific html id&#8217;s involved except for wiring up a trigger from a standard keyup event. &nbsp;This is an important difference: we could rename the id&#8217;s, or switch to some other input control, and not have to rewire everything. &nbsp;We don&#8217;t care about the textbox nor that the textbox&#8217;s value has changed. &nbsp;We care that the textbox respresents the name entered or the email address- and we want to know when the name or email has changed. &nbsp;The favorite link clicked is a good example of this nuanced difference. &nbsp;Take a look at the following html:</p>

<pre class="brush: xml; title: ; notranslate" title="">&lt;a href='#' id='fav1' class='favorite'&gt;My Favorite 1&lt;/a&gt;
&lt;a href='#' id='fav2' class='favorite'&gt;My Favorite 2&lt;/a&gt;
</pre>

<p>Imagine we&#8217;ve wired the click event to fire a FAVORITE_LINK_SELECTED trigger. &nbsp;With this trigger, we don&#8217;t care that the link with id fav1 or fav2 has been clicked, nor the a.favorite selector has been clicked. &nbsp;We don&#8217;t care about ids or css classes. &nbsp;We care a FAVORITE_LINK_SELECTED event has happened because that&#8217;s what the id fav1 and favorite class represents- the favorite link- and we want to know when that has been selected. &nbsp;We can rename the id, change the class, or even change the entire element. &nbsp;As long as FAVORITE_LINK_SELECTED is fired we&#8217;re good to go. &nbsp;Our custom FAVORITE_LINK_SELECTED trigger is the abstraction which creates the loosely coupled system.</p>

<h3 id="conclusion:b1aa778a626daa40c556fbd74954875f">Conclusion</h3>

<p>One thing I haven&#8217;t discuss is how data is passed from trigger to binder. &nbsp;It&#8217;s the other important dependency between triggers and binders which we&#8217;ll discuss in another post. &nbsp;The important thing to take away is why you&#8217;d want to use custom named events to create a loosely coupled system. &nbsp;For very straightforward pages it&#8217;s probably not worth the overhead- the abstraction isn&#8217;t required. &nbsp;However, in a complex form where there are lots of validation dependencies, or many routes to the same function, or when multiple events can trigger an update- you want to use event pooling. &nbsp;More importantly, you want to think about your strategy when it comes to naming events, because it&#8217;s the description linking the caller and method together. &nbsp;You do not want to code yourself into a corner!</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2009/12/help-your-business-be-a-technology-company/">Help Your Business Be A Technology Company</a></h1>
        <span class="post-date">Dec 16 2009</span>
        <p>It doesn&#8217;t matter what industry you work for- every company is a technology company.  At the end of the day a business needs to provide something somebody wants- quickly and efficiently.  This is- quite simply- driven by technology.  And you- as a software developer- are directly responsible for making that happen.  What will separate you from other developers is not how well you program-  it&#8217;s how well you create the right technology to help your business work better.</p>

<p>Unfortunately most people don&#8217;t really understand technology nor how to use it.  I&#8217;m not talking about silly things like printing a pdf or syncing your Outlook calendar- I&#8217;m talking about <em>how technology can optimize business processes.  How technology can both improve efficiency and quickly provide accurate, meaningful information.</em> <em>How technology can be the engine keeping your business two steps ahead of everyone else.</em></p>

<p>Luckily you have an advantage to accomplish this goal: you know how to create technology.  The important thing, however, is knowing both what the business is and also needs so you can help make it work better.  Building software isn&#8217;t nearly as important as knowing what to build.</p>

<p><strong>Don&#8217;t just Program-  Provide Solutions</strong></p>

<p>Don&#8217;t be the type of heads down programmer that wants to be told what to do just so they can code.  People that wait around for requirements and specs are a waste of time and energy.  Everything has to be articulated to a T, then assumptions and misunderstandings lead to bad a deliverable which can sink a ship.  Yes, it&#8217;s important to code and code well, but all too often code eclipses the bigger picture.</p>

<p>As a programmer, your job is to create something to fill a gap.  You need to understand why that gap exists so you can figure out the best way to fill it.  You&#8217;re the programmer- you literally create the solution.  You know what&#8217;s possible and what&#8217;s not- what&#8217;s easy and what&#8217;s hard.  And if you&#8217;re experienced you know the consequences of decisions.  So don&#8217;t blindly accept solutions.  Spend time understanding the problem- come up with the solution- and then work with people to figure out if your solution will solve the problem.</p>

<p><strong>Lead by Listening</strong></p>

<p>Coming up with the solution should not equate to arrogance.  The world, unfortunately, does not revolve around you.  Despite how annoying your users may seem, they are your responsibility and you have an obligation to them.  Nobody likes to be told what to do or have something shoved in their face.  Yes, it is a lot easier for you to just do it yourself and say &#8220;here&#8221;.  Unfortunately, for everybody else, that way sucks.  You need to lead by listening: sit with people, listen to what they have to say, and show that you get &#8220;it&#8221;.</p>

<p>If you listen well you&#8217;re in a better position to explain why you&#8217;re making the decisions you&#8217;re making.  Work with users: build consensus and understanding.  If you have a business advocate who&#8217;s on board with your plan, you have a powerful ally to help create the change you want.  Bounce ideas off of people- and if you think an idea is bad, say so, but always provide an alternative solution.  Being negative and impatient is the quickest way to alienate yourself and have the best idea shot down.</p>

<p><strong>Change the Process</strong></p>

<p>You can only make a car go so fast- at some point, you need to fly.  So don&#8217;t just help the driver drive; help them get to the destination.  Efficiency is key, but it&#8217;s found in unusual ways.  People want to get their job done as quickly as possible with the least amount of annoyance.  Helping them achieve this is often a good thing, but beware: making them do their job better could make a lot of other stuff worse.  It can&#8217;t just be about speeding up the process- the process may need to change.  It&#8217;s up to you to see the big picture and help everybody, not just a single person.  It&#8217;s just like scaling a system: at some point the current process will hit a limit; you need to know what that limit is, when it will happen, and what the hell to do next.</p>

<p>Usually what&#8217;s being asked for is different than what&#8217;s actually needed.  You need to create an &#8220;ah ha&#8221; moment- when you can take all the frustrations and problems of your users, combine them into one solution, and have everyone say &#8220;yes, that&#8217;s perfect&#8221;!  Have a vision.</p>

<p><strong>Roadmap</strong></p>

<p>Sadly, you always have two things against you: time and patience.  Nobody has either.  You can&#8217;t drastically change a users day to day activity.  Imagine if all of a sudden we had to start driving on the wrong side of the road- total chaos would ensue.  It&#8217;s the same thing with drastically changing an application- for the end user, it&#8217;s hard for the long term benefit to outweigh the short term difficulties.  It&#8217;s also a horrible idea to wait a long time for your great solution to be delivered: by that time, it&#8217;s no longer relevant, and everyone&#8217;s forgotten why it&#8217;s important.</p>

<p>Small, incremental changes are key: you need a roadmap to the goal.  That&#8217;s why we have agile.  You need to shepherd the heard to the promise land, and constantly remind them of the goal.  As new requirements come up and new requests come in you need to make sure everything is fitting into that big picture.  People may even come in with quick one-offs as stop gap measures- the biggest setback for moving forward.  You need to be able to say &#8220;Here&#8217;s why this is bad&#8221; and provide better alternatives. If something must happen quicker, prioritize, refactor and meet half way.  Agile development has numerous benefits:</p>

<ul>
<li>You can provide iterative releases.  People can see progress unfold.</li>
<li>You get in refactor/response cycles.  It&#8217;s amazing how excited and appreciative people are if you make a change they ask for- no matter how small.  If something isn&#8217;t working as envisioned, and gets changed quickly, you are a rock star.</li>
<li>You can deliver faster: software can be used when it&#8217;s usable, not when it&#8217;s finished.</li>
<li>Things can be prioritized.  When you can&#8217;t do something somebody wants, it&#8217;s not a surprise.  If you communicate well they know why it didn&#8217;t happen.</li>
<li>The learning curve upon delivery is minimized.  People know what they&#8217;re getting and how it works.  After all, they were part of the design.</li>
</ul>

<p><strong>The Deliverable is not the Release</strong></p>

<p>Good software is something that people like using.  At the end of the day, it doesn&#8217;t matter which design patterns were used, how cool your ajax widget was, or even how many bugs the product has.  Writing code well does not equal a good product.  If it doesn&#8217;t help somebody do something better you wasted a lot of time- particularly your own and even worse your users.  That&#8217;s why time to market is so essential- it gets the product used sooner so reactions can be gauged and adjustments made.  Bells and whistles are nice to haves, but at the end of the day you need to ask yourself how important was it really?  Would a simple web 1.0 form have been better? Would it have been easier to use and quicker to develop? Is this thing that I&#8217;m doing actually solving a problem?</p>

<p>All of these questions equate to a simple rational:  Am I giving my business what it needs? The better you are at answering that question the better you&#8217;ll be at programming the solution.</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2009/12/hdr-photography/">HDR Photography</a></h1>
        <span class="post-date">Dec 5 2009</span>
        <div style="text-align: left; padding: 3px;">
  <a title="photo sharing" href="http://www.flickr.com/photos/hamrah/4141374402/"><img style="border: solid 2px #000000;" src="http://i0.wp.com/farm3.static.flickr.com/2716/4141374402_d8eb9257df.jpg?w=660" alt="" data-recalc-dims="1" /></a></p> 
  
  <p>
    <span style="font-size: 0.8em; margin-top: 0px;"><a href="http://www.flickr.com/photos/hamrah/4141374402/">fox glacier sunset at lake-24</a>, originally uploaded by <a href="http://www.flickr.com/people/hamrah/">mhamrah</a>.</span></div> 
    

<pre><code>&lt;p&gt;
  I&amp;#8217;ve been playing around with HDR photography after coming back from an incredible vacation to New Zealand. This photo came out especially well.
&lt;/p&gt;
</code></pre>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://blog.michaelhamrah.com/2009/06/appstorm-giveaway/">AppStorm Giveaway!</a></h1>
        <span class="post-date">Jun 24 2009</span>
        <p><a href="http://mac.appstorm.net">AppStorm</a> is an incredible site which reviews Mac software. I&#8217;ve followed their reviews for a while and it&#8217;s made my Mac 8000% more awesome. They frequently give away software- currently copies of Flux and Forklift are up for grabs. <a href="http://mac.appstorm.net/general/competitions/the-mega-giveaway-forklift-flux/">so check it out!</a></p>

    </div>
  
</div>

<div class="pagination">
  
  <a class="pagination-item older" href="http://blog.michaelhamrah.com/page/8/">Older</a>
  

  
  <a class="pagination-item newer" href="http://blog.michaelhamrah.com/page/6/">Newer</a>
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-6576586-1', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>

